{"ast":null,"code":"\"use strict\";\n\n// Copyright (c) 2018-2020 WalletLink.org <https://www.walletlink.org/>\n// Copyright (c) 2018-2020 Coinbase, Inc. <https://www.coinbase.com/>\n// Licensed under the Apache License, version 2.0\nvar _classCallCheck = require(\"E:\\\\testprojects\\\\CoolSwap-interface\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/classCallCheck\");\nvar _createClass = require(\"E:\\\\testprojects\\\\CoolSwap-interface\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/createClass\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Session = void 0;\nvar js_sha256_1 = require(\"js-sha256\");\nvar rxjs_1 = require(\"rxjs\");\nvar operators_1 = require(\"rxjs/operators\");\nvar util_1 = require(\"../util\");\nvar STORAGE_KEY_SESSION_ID = \"session:id\";\nvar STORAGE_KEY_SESSION_SECRET = \"session:secret\";\nvar STORAGE_KEY_SESSION_LINKED = \"session:linked\";\nvar Session = /*#__PURE__*/function () {\n  function Session(storage, id, secret, linked) {\n    _classCallCheck(this, Session);\n    this._storage = storage;\n    this._id = id || (0, util_1.randomBytesHex)(16);\n    this._secret = secret || (0, util_1.randomBytesHex)(32);\n    var hash = js_sha256_1.sha256.create();\n    hash.update(\"\".concat(this._id, \", \").concat(this._secret, \" WalletLink\"));\n    this._key = hash.hex();\n    this._linked = !!linked;\n  }\n  _createClass(Session, [{\n    key: \"id\",\n    get: function get() {\n      return this._id;\n    }\n  }, {\n    key: \"secret\",\n    get: function get() {\n      return this._secret;\n    }\n  }, {\n    key: \"key\",\n    get: function get() {\n      return this._key;\n    }\n  }, {\n    key: \"linked\",\n    get: function get() {\n      return this._linked;\n    },\n    set: function set(val) {\n      this._linked = val;\n      this.persistLinked();\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      this._storage.setItem(STORAGE_KEY_SESSION_ID, this._id);\n      this._storage.setItem(STORAGE_KEY_SESSION_SECRET, this._secret);\n      this.persistLinked();\n      return this;\n    }\n  }, {\n    key: \"persistLinked\",\n    value: function persistLinked() {\n      this._storage.setItem(STORAGE_KEY_SESSION_LINKED, this._linked ? \"1\" : \"0\");\n    }\n  }], [{\n    key: \"load\",\n    value: function load(storage) {\n      var id = storage.getItem(STORAGE_KEY_SESSION_ID);\n      var linked = storage.getItem(STORAGE_KEY_SESSION_LINKED);\n      var secret = storage.getItem(STORAGE_KEY_SESSION_SECRET);\n      if (id && secret) {\n        return new Session(storage, id, secret, linked === \"1\");\n      }\n      return null;\n    }\n  }, {\n    key: \"persistedSessionIdChange$\",\n    get: function get() {\n      return (0, rxjs_1.fromEvent)(window, \"storage\").pipe((0, operators_1.filter)(function (evt) {\n        return evt.key === STORAGE_KEY_SESSION_ID;\n      }), (0, operators_1.map)(function (evt) {\n        return {\n          oldValue: evt.oldValue || null,\n          newValue: evt.newValue || null\n        };\n      }));\n    }\n    /**\n     * Takes in a session ID and returns the sha256 hash of it.\n     * @param sessionId session ID\n     */\n  }, {\n    key: \"hash\",\n    value: function hash(sessionId) {\n      var hash = js_sha256_1.sha256.create();\n      return hash.update(sessionId).hex();\n    }\n  }]);\n  return Session;\n}();\nexports.Session = Session;","map":{"version":3,"names":["_classCallCheck","require","_createClass","Object","defineProperty","exports","value","Session","js_sha256_1","rxjs_1","operators_1","util_1","STORAGE_KEY_SESSION_ID","STORAGE_KEY_SESSION_SECRET","STORAGE_KEY_SESSION_LINKED","storage","id","secret","linked","_storage","_id","randomBytesHex","_secret","hash","sha256","create","update","concat","_key","hex","_linked","key","get","set","val","persistLinked","save","setItem","load","getItem","fromEvent","window","pipe","filter","evt","map","oldValue","newValue","sessionId"],"sources":["E:/testprojects/CoolSwap-interface/node_modules/walletlink/dist/relay/Session.js"],"sourcesContent":["\"use strict\";\n// Copyright (c) 2018-2020 WalletLink.org <https://www.walletlink.org/>\n// Copyright (c) 2018-2020 Coinbase, Inc. <https://www.coinbase.com/>\n// Licensed under the Apache License, version 2.0\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Session = void 0;\nconst js_sha256_1 = require(\"js-sha256\");\nconst rxjs_1 = require(\"rxjs\");\nconst operators_1 = require(\"rxjs/operators\");\nconst util_1 = require(\"../util\");\nconst STORAGE_KEY_SESSION_ID = \"session:id\";\nconst STORAGE_KEY_SESSION_SECRET = \"session:secret\";\nconst STORAGE_KEY_SESSION_LINKED = \"session:linked\";\nclass Session {\n    constructor(storage, id, secret, linked) {\n        this._storage = storage;\n        this._id = id || (0, util_1.randomBytesHex)(16);\n        this._secret = secret || (0, util_1.randomBytesHex)(32);\n        const hash = js_sha256_1.sha256.create();\n        hash.update(`${this._id}, ${this._secret} WalletLink`);\n        this._key = hash.hex();\n        this._linked = !!linked;\n    }\n    static load(storage) {\n        const id = storage.getItem(STORAGE_KEY_SESSION_ID);\n        const linked = storage.getItem(STORAGE_KEY_SESSION_LINKED);\n        const secret = storage.getItem(STORAGE_KEY_SESSION_SECRET);\n        if (id && secret) {\n            return new Session(storage, id, secret, linked === \"1\");\n        }\n        return null;\n    }\n    static get persistedSessionIdChange$() {\n        return (0, rxjs_1.fromEvent)(window, \"storage\").pipe((0, operators_1.filter)(evt => evt.key === STORAGE_KEY_SESSION_ID), (0, operators_1.map)(evt => ({\n            oldValue: evt.oldValue || null,\n            newValue: evt.newValue || null\n        })));\n    }\n    /**\n     * Takes in a session ID and returns the sha256 hash of it.\n     * @param sessionId session ID\n     */\n    static hash(sessionId) {\n        const hash = js_sha256_1.sha256.create();\n        return hash.update(sessionId).hex();\n    }\n    get id() {\n        return this._id;\n    }\n    get secret() {\n        return this._secret;\n    }\n    get key() {\n        return this._key;\n    }\n    get linked() {\n        return this._linked;\n    }\n    set linked(val) {\n        this._linked = val;\n        this.persistLinked();\n    }\n    save() {\n        this._storage.setItem(STORAGE_KEY_SESSION_ID, this._id);\n        this._storage.setItem(STORAGE_KEY_SESSION_SECRET, this._secret);\n        this.persistLinked();\n        return this;\n    }\n    persistLinked() {\n        this._storage.setItem(STORAGE_KEY_SESSION_LINKED, this._linked ? \"1\" : \"0\");\n    }\n}\nexports.Session = Session;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}