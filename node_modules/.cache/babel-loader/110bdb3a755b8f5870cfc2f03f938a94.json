{"ast":null,"code":"/** PURE_IMPORTS_START _Observable,_util_identity,_util_isScheduler PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { identity } from '../util/identity';\nimport { isScheduler } from '../util/isScheduler';\nexport function generate(initialStateOrOptions, condition, iterate, resultSelectorOrObservable, scheduler) {\n  var resultSelector;\n  var initialState;\n  if (arguments.length == 1) {\n    var options = initialStateOrOptions;\n    initialState = options.initialState;\n    condition = options.condition;\n    iterate = options.iterate;\n    resultSelector = options.resultSelector || identity;\n    scheduler = options.scheduler;\n  } else if (resultSelectorOrObservable === undefined || isScheduler(resultSelectorOrObservable)) {\n    initialState = initialStateOrOptions;\n    resultSelector = identity;\n    scheduler = resultSelectorOrObservable;\n  } else {\n    initialState = initialStateOrOptions;\n    resultSelector = resultSelectorOrObservable;\n  }\n  return new Observable(function (subscriber) {\n    var state = initialState;\n    if (scheduler) {\n      return scheduler.schedule(dispatch, 0, {\n        subscriber: subscriber,\n        iterate: iterate,\n        condition: condition,\n        resultSelector: resultSelector,\n        state: state\n      });\n    }\n    do {\n      if (condition) {\n        var conditionResult = void 0;\n        try {\n          conditionResult = condition(state);\n        } catch (err) {\n          subscriber.error(err);\n          return undefined;\n        }\n        if (!conditionResult) {\n          subscriber.complete();\n          break;\n        }\n      }\n      var value = void 0;\n      try {\n        value = resultSelector(state);\n      } catch (err) {\n        subscriber.error(err);\n        return undefined;\n      }\n      subscriber.next(value);\n      if (subscriber.closed) {\n        break;\n      }\n      try {\n        state = iterate(state);\n      } catch (err) {\n        subscriber.error(err);\n        return undefined;\n      }\n    } while (true);\n    return undefined;\n  });\n}\nfunction dispatch(state) {\n  var subscriber = state.subscriber,\n    condition = state.condition;\n  if (subscriber.closed) {\n    return undefined;\n  }\n  if (state.needIterate) {\n    try {\n      state.state = state.iterate(state.state);\n    } catch (err) {\n      subscriber.error(err);\n      return undefined;\n    }\n  } else {\n    state.needIterate = true;\n  }\n  if (condition) {\n    var conditionResult = void 0;\n    try {\n      conditionResult = condition(state.state);\n    } catch (err) {\n      subscriber.error(err);\n      return undefined;\n    }\n    if (!conditionResult) {\n      subscriber.complete();\n      return undefined;\n    }\n    if (subscriber.closed) {\n      return undefined;\n    }\n  }\n  var value;\n  try {\n    value = state.resultSelector(state.state);\n  } catch (err) {\n    subscriber.error(err);\n    return undefined;\n  }\n  if (subscriber.closed) {\n    return undefined;\n  }\n  subscriber.next(value);\n  if (subscriber.closed) {\n    return undefined;\n  }\n  return this.schedule(state);\n}","map":{"version":3,"names":["Observable","identity","isScheduler","generate","initialStateOrOptions","condition","iterate","resultSelectorOrObservable","scheduler","resultSelector","initialState","arguments","length","options","undefined","subscriber","state","schedule","dispatch","conditionResult","err","error","complete","value","next","closed","needIterate"],"sources":["../../../src/internal/observable/generate.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module"}