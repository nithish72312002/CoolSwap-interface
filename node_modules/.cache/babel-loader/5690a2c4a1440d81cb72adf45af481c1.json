{"ast":null,"code":"\"use strict\";\n\n// Copyright (c) 2018-2020 WalletLink.org <https://www.walletlink.org/>\n// Copyright (c) 2018-2020 Coinbase, Inc. <https://www.coinbase.com/>\n// Licensed under the Apache License, version 2.0\nvar _classCallCheck = require(\"E:\\\\testprojects\\\\CoolSwap-interface\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/classCallCheck\");\nvar _createClass = require(\"E:\\\\testprojects\\\\CoolSwap-interface\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/createClass\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.LinkFlow = void 0;\nvar preact_1 = require(\"preact\");\nvar rxjs_1 = require(\"rxjs\");\nvar operators_1 = require(\"rxjs/operators\");\nvar LinkDialog_1 = require(\"./LinkDialog\");\nvar TryExtensionLinkDialog_1 = require(\"./TryExtensionLinkDialog\");\nvar LinkFlow = /*#__PURE__*/function () {\n  function LinkFlow(options) {\n    var _this = this;\n    _classCallCheck(this, LinkFlow);\n    this.extensionUI$ = new rxjs_1.BehaviorSubject({});\n    this.subscriptions = new rxjs_1.Subscription();\n    this.isConnected = false;\n    this.isOpen = false;\n    this.onCancel = null;\n    this.root = null;\n    // if true, hide QR code in LinkFlow (which happens if no jsonRpcUrl is provided)\n    this.connectDisabled = false;\n    this.darkMode = options.darkMode;\n    this.version = options.version;\n    this.sessionId = options.sessionId;\n    this.sessionSecret = options.sessionSecret;\n    this.walletLinkUrl = options.walletLinkUrl;\n    this.isParentConnection = options.isParentConnection;\n    this.connected$ = options.connected$;\n    // Check if extension UI is enabled\n    fetch(\"https://api.wallet.coinbase.com/rpc/v2/getFeatureFlags\").then(function (res) {\n      return res.json();\n    }).then(function (json) {\n      var enabled = json.result.desktop.extension_ui;\n      if (typeof enabled === \"undefined\") {\n        _this.extensionUI$.next({\n          value: false\n        });\n      } else {\n        _this.extensionUI$.next({\n          value: enabled\n        });\n      }\n    }).catch(function (err) {\n      console.error('Couldn\\'t fetch feature flags - ', err);\n      _this.extensionUI$.next({\n        value: false\n      });\n    });\n  }\n  _createClass(LinkFlow, [{\n    key: \"attach\",\n    value: function attach(el) {\n      var _this2 = this;\n      this.root = document.createElement(\"div\");\n      this.root.className = \"-walletlink-link-flow-root\";\n      el.appendChild(this.root);\n      this.render();\n      this.subscriptions.add(this.connected$.subscribe(function (v) {\n        if (_this2.isConnected !== v) {\n          _this2.isConnected = v;\n          _this2.render();\n        }\n      }));\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      var _a;\n      if (!this.root) {\n        return;\n      }\n      this.subscriptions.unsubscribe();\n      (0, preact_1.render)(null, this.root);\n      (_a = this.root.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(this.root);\n    }\n  }, {\n    key: \"setConnectDisabled\",\n    value: function setConnectDisabled(connectDisabled) {\n      this.connectDisabled = connectDisabled;\n    }\n  }, {\n    key: \"open\",\n    value: function open(options) {\n      this.isOpen = true;\n      this.onCancel = options.onCancel;\n      this.render();\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      this.isOpen = false;\n      this.onCancel = null;\n      this.render();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n      if (!this.root) {\n        return;\n      }\n      var subscription = this.extensionUI$.pipe((0, operators_1.first)(function (enabled) {\n        return enabled.value !== undefined;\n      })) // wait for a valid value before rendering\n      .subscribe(function (enabled) {\n        if (!_this3.root) {\n          return;\n        }\n        (0, preact_1.render)(enabled.value ? (0, preact_1.h)(TryExtensionLinkDialog_1.TryExtensionLinkDialog, {\n          darkMode: _this3.darkMode,\n          version: _this3.version,\n          sessionId: _this3.sessionId,\n          sessionSecret: _this3.sessionSecret,\n          walletLinkUrl: _this3.walletLinkUrl,\n          isOpen: _this3.isOpen,\n          isConnected: _this3.isConnected,\n          isParentConnection: _this3.isParentConnection,\n          onCancel: _this3.onCancel,\n          connectDisabled: _this3.connectDisabled\n        }) : (0, preact_1.h)(LinkDialog_1.LinkDialog, {\n          darkMode: _this3.darkMode,\n          version: _this3.version,\n          sessionId: _this3.sessionId,\n          sessionSecret: _this3.sessionSecret,\n          walletLinkUrl: _this3.walletLinkUrl,\n          isOpen: _this3.isOpen,\n          isConnected: _this3.isConnected,\n          isParentConnection: _this3.isParentConnection,\n          onCancel: _this3.onCancel\n        }), _this3.root);\n      });\n      this.subscriptions.add(subscription);\n    }\n  }]);\n  return LinkFlow;\n}();\nexports.LinkFlow = LinkFlow;","map":{"version":3,"names":["_classCallCheck","require","_createClass","Object","defineProperty","exports","value","LinkFlow","preact_1","rxjs_1","operators_1","LinkDialog_1","TryExtensionLinkDialog_1","options","_this","extensionUI$","BehaviorSubject","subscriptions","Subscription","isConnected","isOpen","onCancel","root","connectDisabled","darkMode","version","sessionId","sessionSecret","walletLinkUrl","isParentConnection","connected$","fetch","then","res","json","enabled","result","desktop","extension_ui","next","catch","err","console","error","key","attach","el","_this2","document","createElement","className","appendChild","render","add","subscribe","v","detach","_a","unsubscribe","parentElement","removeChild","setConnectDisabled","open","close","_this3","subscription","pipe","first","undefined","h","TryExtensionLinkDialog","LinkDialog"],"sources":["E:/testprojects/CoolSwap-interface/node_modules/walletlink/dist/components/LinkFlow.js"],"sourcesContent":["\"use strict\";\n// Copyright (c) 2018-2020 WalletLink.org <https://www.walletlink.org/>\n// Copyright (c) 2018-2020 Coinbase, Inc. <https://www.coinbase.com/>\n// Licensed under the Apache License, version 2.0\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.LinkFlow = void 0;\nconst preact_1 = require(\"preact\");\nconst rxjs_1 = require(\"rxjs\");\nconst operators_1 = require(\"rxjs/operators\");\nconst LinkDialog_1 = require(\"./LinkDialog\");\nconst TryExtensionLinkDialog_1 = require(\"./TryExtensionLinkDialog\");\nclass LinkFlow {\n    constructor(options) {\n        this.extensionUI$ = new rxjs_1.BehaviorSubject({});\n        this.subscriptions = new rxjs_1.Subscription();\n        this.isConnected = false;\n        this.isOpen = false;\n        this.onCancel = null;\n        this.root = null;\n        // if true, hide QR code in LinkFlow (which happens if no jsonRpcUrl is provided)\n        this.connectDisabled = false;\n        this.darkMode = options.darkMode;\n        this.version = options.version;\n        this.sessionId = options.sessionId;\n        this.sessionSecret = options.sessionSecret;\n        this.walletLinkUrl = options.walletLinkUrl;\n        this.isParentConnection = options.isParentConnection;\n        this.connected$ = options.connected$;\n        // Check if extension UI is enabled\n        fetch(\"https://api.wallet.coinbase.com/rpc/v2/getFeatureFlags\")\n            .then(res => res.json())\n            .then(json => {\n            const enabled = json.result.desktop.extension_ui;\n            if (typeof enabled === \"undefined\") {\n                this.extensionUI$.next({ value: false });\n            }\n            else {\n                this.extensionUI$.next({ value: enabled });\n            }\n        })\n            .catch(err => {\n            console.error('Couldn\\'t fetch feature flags - ', err);\n            this.extensionUI$.next({ value: false });\n        });\n    }\n    attach(el) {\n        this.root = document.createElement(\"div\");\n        this.root.className = \"-walletlink-link-flow-root\";\n        el.appendChild(this.root);\n        this.render();\n        this.subscriptions.add(this.connected$.subscribe(v => {\n            if (this.isConnected !== v) {\n                this.isConnected = v;\n                this.render();\n            }\n        }));\n    }\n    detach() {\n        var _a;\n        if (!this.root) {\n            return;\n        }\n        this.subscriptions.unsubscribe();\n        (0, preact_1.render)(null, this.root);\n        (_a = this.root.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(this.root);\n    }\n    setConnectDisabled(connectDisabled) {\n        this.connectDisabled = connectDisabled;\n    }\n    open(options) {\n        this.isOpen = true;\n        this.onCancel = options.onCancel;\n        this.render();\n    }\n    close() {\n        this.isOpen = false;\n        this.onCancel = null;\n        this.render();\n    }\n    render() {\n        if (!this.root) {\n            return;\n        }\n        const subscription = this.extensionUI$\n            .pipe((0, operators_1.first)(enabled => enabled.value !== undefined)) // wait for a valid value before rendering\n            .subscribe(enabled => {\n            if (!this.root) {\n                return;\n            }\n            (0, preact_1.render)(enabled.value ? ((0, preact_1.h)(TryExtensionLinkDialog_1.TryExtensionLinkDialog, { darkMode: this.darkMode, version: this.version, sessionId: this.sessionId, sessionSecret: this.sessionSecret, walletLinkUrl: this.walletLinkUrl, isOpen: this.isOpen, isConnected: this.isConnected, isParentConnection: this.isParentConnection, onCancel: this.onCancel, connectDisabled: this.connectDisabled })) : ((0, preact_1.h)(LinkDialog_1.LinkDialog, { darkMode: this.darkMode, version: this.version, sessionId: this.sessionId, sessionSecret: this.sessionSecret, walletLinkUrl: this.walletLinkUrl, isOpen: this.isOpen, isConnected: this.isConnected, isParentConnection: this.isParentConnection, onCancel: this.onCancel })), this.root);\n        });\n        this.subscriptions.add(subscription);\n    }\n}\nexports.LinkFlow = LinkFlow;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}