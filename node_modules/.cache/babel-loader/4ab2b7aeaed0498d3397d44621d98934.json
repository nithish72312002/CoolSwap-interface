{"ast":null,"code":"import { AbstractConnector } from '@web3-react/abstract-connector';\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  _setPrototypeOf(subClass, superClass);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nvar CHAIN_ID = 1;\nvar WalletLinkConnector = /*#__PURE__*/function (_AbstractConnector) {\n  _inheritsLoose(WalletLinkConnector, _AbstractConnector);\n  function WalletLinkConnector(_ref) {\n    var _this;\n    var url = _ref.url,\n      appName = _ref.appName,\n      appLogoUrl = _ref.appLogoUrl,\n      darkMode = _ref.darkMode;\n    _this = _AbstractConnector.call(this, {\n      supportedChainIds: [CHAIN_ID]\n    }) || this;\n    _this.url = url;\n    _this.appName = appName;\n    _this.appLogoUrl = appLogoUrl;\n    _this.darkMode = darkMode || false;\n    return _this;\n  }\n  var _proto = WalletLinkConnector.prototype;\n  _proto.activate = function activate() {\n    try {\n      var _this3 = this;\n      var _temp3 = function _temp3() {\n        return Promise.resolve(_this3.provider.send('eth_requestAccounts').then(function (accounts) {\n          return accounts[0];\n        })).then(function (account) {\n          _this3.provider.on('chainChanged', _this3.handleChainChanged);\n          _this3.provider.on('accountsChanged', _this3.handleAccountsChanged);\n          return {\n            provider: _this3.provider,\n            chainId: CHAIN_ID,\n            account: account\n          };\n        });\n      };\n      var _temp4 = function () {\n        if (!_this3.walletLink) {\n          return Promise.resolve(import('walletlink').then(function (m) {\n            var _m$default;\n            return (_m$default = m == null ? void 0 : m[\"default\"]) != null ? _m$default : m;\n          })).then(function (WalletLink) {\n            _this3.walletLink = new WalletLink(_extends({\n              appName: _this3.appName,\n              darkMode: _this3.darkMode\n            }, _this3.appLogoUrl ? {\n              appLogoUrl: _this3.appLogoUrl\n            } : {}));\n            _this3.provider = _this3.walletLink.makeWeb3Provider(_this3.url, CHAIN_ID);\n          });\n        }\n      }();\n      return Promise.resolve(_temp4 && _temp4.then ? _temp4.then(_temp3) : _temp3(_temp4));\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  _proto.getProvider = function getProvider() {\n    try {\n      var _this5 = this;\n      return Promise.resolve(_this5.provider);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  _proto.getChainId = function getChainId() {\n    return Promise.resolve(CHAIN_ID);\n  };\n  _proto.getAccount = function getAccount() {\n    try {\n      var _this7 = this;\n      return Promise.resolve(_this7.provider.send('eth_accounts').then(function (accounts) {\n        return accounts[0];\n      }));\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  _proto.deactivate = function deactivate() {\n    this.provider.removeListener('chainChanged', this.handleChainChanged);\n    this.provider.removeListener('accountsChanged', this.handleAccountsChanged);\n  };\n  _proto.close = function close() {\n    try {\n      var _this9 = this;\n      _this9.provider.close();\n      _this9.emitDeactivate();\n      return Promise.resolve();\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  _proto.handleChainChanged = function handleChainChanged(chainId) {\n    if (process.env.NODE_ENV !== \"production\") {\n      console.log(\"Handling 'chainChanged' event with payload\", chainId);\n    }\n    this.emitUpdate({\n      chainId: chainId\n    });\n  };\n  _proto.handleAccountsChanged = function handleAccountsChanged(accounts) {\n    if (process.env.NODE_ENV !== \"production\") {\n      console.log(\"Handling 'accountsChanged' event with payload\", accounts);\n    }\n    this.emitUpdate({\n      account: accounts[0]\n    });\n  };\n  return WalletLinkConnector;\n}(AbstractConnector);\nexport { WalletLinkConnector };","map":{"version":3,"names":["CHAIN_ID","WalletLinkConnector","_AbstractConnector","_inheritsLoose","_ref","url","appName","appLogoUrl","darkMode","_this","call","supportedChainIds","_proto","prototype","activate","_this3","provider","send","then","accounts","account","on","handleChainChanged","handleAccountsChanged","chainId","walletLink","m","_m$default","WalletLink","_extends","makeWeb3Provider","e","Promise","reject","getProvider","resolve","_this5","getChainId","getAccount","_this7","deactivate","removeListener","close","_this9","emitDeactivate","process","env","NODE_ENV","console","log","emitUpdate","AbstractConnector"],"sources":["../src/index.ts"],"sourcesContent":["import { ConnectorUpdate } from '@web3-react/types'\nimport { AbstractConnector } from '@web3-react/abstract-connector'\n\nconst CHAIN_ID = 1\n\ninterface WalletLinkConnectorArguments {\n  url: string\n  appName: string\n  appLogoUrl?: string\n  darkMode?: boolean\n}\n\nexport class WalletLinkConnector extends AbstractConnector {\n  private readonly url: string\n  private readonly appName: string\n  private readonly appLogoUrl?: string\n  private readonly darkMode: boolean\n\n  public walletLink: any\n  private provider: any\n\n  constructor({ url, appName, appLogoUrl, darkMode }: WalletLinkConnectorArguments) {\n    super({ supportedChainIds: [CHAIN_ID] })\n\n    this.url = url\n    this.appName = appName\n    this.appLogoUrl = appLogoUrl\n    this.darkMode = darkMode || false\n  }\n\n  public async activate(): Promise<ConnectorUpdate> {\n    if (!this.walletLink) {\n      const WalletLink = await import('walletlink').then(m => m?.default ?? m)\n      this.walletLink = new WalletLink({\n        appName: this.appName,\n        darkMode: this.darkMode,\n        ...(this.appLogoUrl ? { appLogoUrl: this.appLogoUrl } : {})\n      })\n      this.provider = this.walletLink.makeWeb3Provider(this.url, CHAIN_ID)\n    }\n\n    const account = await this.provider.send('eth_requestAccounts').then((accounts: string[]): string => accounts[0])\n\n    this.provider.on('chainChanged', this.handleChainChanged)\n    this.provider.on('accountsChanged', this.handleAccountsChanged)\n\n    return { provider: this.provider, chainId: CHAIN_ID, account: account }\n  }\n\n  public async getProvider(): Promise<any> {\n    return this.provider\n  }\n\n  public async getChainId(): Promise<number> {\n    return CHAIN_ID\n  }\n\n  public async getAccount(): Promise<null | string> {\n    return this.provider.send('eth_accounts').then((accounts: string[]): string => accounts[0])\n  }\n\n  public deactivate() {\n    this.provider.removeListener('chainChanged', this.handleChainChanged)\n    this.provider.removeListener('accountsChanged', this.handleAccountsChanged)\n  }\n\n  public async close() {\n    this.provider.close()\n    this.emitDeactivate()\n  }\n\n  private handleChainChanged(chainId: number | string): void {\n    if (__DEV__) {\n      console.log(\"Handling 'chainChanged' event with payload\", chainId)\n    }\n    this.emitUpdate({ chainId })\n  }\n\n  private handleAccountsChanged(accounts: string[]): void {\n    if (__DEV__) {\n      console.log(\"Handling 'accountsChanged' event with payload\", accounts)\n    }\n    this.emitUpdate({ account: accounts[0] })\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}