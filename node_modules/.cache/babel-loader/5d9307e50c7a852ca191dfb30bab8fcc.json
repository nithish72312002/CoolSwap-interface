{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function get() {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar color_1 = require(\"./color\");\nvar builder_1 = __importDefault(require(\"./builder\"));\nvar Util = __importStar(require(\"./util\"));\nvar Quantizer = __importStar(require(\"./quantizer\"));\nvar Generator = __importStar(require(\"./generator\"));\nvar Filters = __importStar(require(\"./filter\"));\nvar defaults = require(\"lodash/defaults\");\nvar Vibrant = /** @class */function () {\n  function Vibrant(_src, opts) {\n    this._src = _src;\n    this.opts = defaults({}, opts, Vibrant.DefaultOpts);\n    this.opts.combinedFilter = Filters.combineFilters(this.opts.filters);\n  }\n  Vibrant.from = function (src) {\n    return new builder_1.default(src);\n  };\n  Vibrant.prototype._process = function (image, opts) {\n    var quantizer = opts.quantizer,\n      generator = opts.generator;\n    image.scaleDown(opts);\n    return image.applyFilter(opts.combinedFilter).then(function (imageData) {\n      return quantizer(imageData.data, opts);\n    }).then(function (colors) {\n      return color_1.Swatch.applyFilter(colors, opts.combinedFilter);\n    }).then(function (colors) {\n      return Promise.resolve(generator(colors));\n    });\n  };\n  Vibrant.prototype.palette = function () {\n    return this.swatches();\n  };\n  Vibrant.prototype.swatches = function () {\n    return this._palette;\n  };\n  Vibrant.prototype.getPalette = function (cb) {\n    var _this = this;\n    var image = new this.opts.ImageClass();\n    var result = image.load(this._src).then(function (image) {\n      return _this._process(image, _this.opts);\n    }).then(function (palette) {\n      _this._palette = palette;\n      image.remove();\n      return palette;\n    }, function (err) {\n      image.remove();\n      throw err;\n    });\n    if (cb) result.then(function (palette) {\n      return cb(null, palette);\n    }, function (err) {\n      return cb(err);\n    });\n    return result;\n  };\n  Vibrant.Builder = builder_1.default;\n  Vibrant.Quantizer = Quantizer;\n  Vibrant.Generator = Generator;\n  Vibrant.Filter = Filters;\n  Vibrant.Util = Util;\n  Vibrant.Swatch = color_1.Swatch;\n  Vibrant.DefaultOpts = {\n    colorCount: 64,\n    quality: 5,\n    generator: Generator.Default,\n    ImageClass: null,\n    quantizer: Quantizer.MMCQ,\n    filters: [Filters.Default]\n  };\n  return Vibrant;\n}();\nexports.default = Vibrant;","map":{"version":3,"names":["color_1","require","builder_1","__importDefault","Util","__importStar","Quantizer","Generator","Filters","defaults","Vibrant","_src","opts","DefaultOpts","combinedFilter","combineFilters","filters","from","src","default","prototype","_process","image","quantizer","generator","scaleDown","applyFilter","then","imageData","data","colors","Swatch","Promise","resolve","palette","swatches","_palette","getPalette","cb","_this","ImageClass","result","load","remove","err","Builder","Filter","colorCount","quality","Default","MMCQ","exports"],"sources":["../src/vibrant.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script"}